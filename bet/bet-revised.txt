Why You Should BET on Your Blocks

<h2> Motivation </h3>

The Saito Consensus Protocol is most often looked discussed in terms of block production as that is where its two primary innovations ameliorate fundamental issues. What is often black-boxed in conceptions is what happens after a block is produced. As an *open* consensus model, there is no block attestation and as a high bandwidth chain, that the basic incentives of Bitcoin adapt perfectly to Saito is not obvious.

In Bitcoin a successful miner propagates his block as quickly as possible to increase the chance that the view of consensus where he earns a mining reward is adopted - and unsuccessful miners adopt that view because it gives them a head-start to mine on the newest block rather than burning resources on old history. The long blocktime and small blocksize of Bitcoin make managing forks relatively inexpensive and infrequent.

Where Saito most differs is its potentially high block size and short block time. The question "what to do if I receive two blocks at once," is technically almost non-nonsensical; given the way networks operate it is only possible for a client to receive one whole block before another - the question of which block to adopt and propagate is thus always "the first one."

But the basic innovation of Bitcoin exists for a reason: different parts of the network need to come to consensus when they receive different data; that innovation is adopt the longest chain over all others (and to add cost to creating it). In Bitcoin, where fork rate is low, and block verification is cheap, shifting one's view of consensus in this way is easy. But in a high-bandwidth blockchain, this process is almost by definition tangibly costly - after wasting time and resources building an orphaned fork, that same time and energy must be applied just to catch up to the canonical chain. Though this may likely only amount to single block revisions, the unconstrained block size of Saito still allows for these to be relatively costly ordeals.

Due to the nature of decentralized networks and how blockchains settle disputes, these forks will happen and resolving them will be costly for some subset of the network both in terms of loss of potential rewards and in rebuilding the tail of the chain. This protocol of building on the fork one receives first and hoping not to find a longer one is an ambient cost the whole network must factor in which ultimately slows the average time to consensus and increases the cost of running a node. If these costs can be reduced, it will not only allow for more nodes to participate in consensus, but also translate to lower fees for users.

In Ethereum, with fundamental compromises on openness, forks are, barring any issues, largely determined upfront; one does not wait for a longer chain to emerge, but for multiple blocks competing for adoption at a single depth (or 'slot') to collect attestations from stakers with slashing as a punishment for disrupting this process. Saito does have staking, but it may be more accurately referred to as *holder reflections* as the balances have no slashing condition - it is more of a secure sink for excess rewards.

<h2> Existing Incentives for Consensus Between Forks </h2>

So without introducing closure, Saito must rely on market incentives to help the network decide on which fork to adopt before seeing which is longest; first one received is usually the best bet. But there are some reasonss participants can and will desire to influence nodes onto a certain fork: the clearest is the fee and reward attached to Golden Ticket rewards - these are miners' claims on block reward. No participants can earn rewards, and the chain is not valid unless these proof of work "Golden Tickets" are included. These tickets must include work related to the previous block, are costly to produce, and necessary for reward distribution and chain validity; needless to say, the fork containing Golden Tickets will be strongly preferred to one with less.

Golden Ticket miners can also compete for inclusion by increasing the fees on the Golden Ticket transactions, since only one is rewarded per block. This incentivizes them to propagate their work as quickly as possible (hence the large fee), and the news of this solution to the network solidifies their fork choice. Not only this, but the fee can settle disputes between two forks who recieved Golden Tickets around the same time - even if deep nodes cannot claim substantial reward from the fee, the high fee signals that one Golden Ticket and its associated fork is likely being preferred by the rest of the network. But this dynamic still requires waiting and hoping one's fork will come out on top; the potential length of orphaned forks and the cost to revise them increases when, due to bad luck, valid Golden Tickets do not appear for multiple blocks. Miners also bear the cost of competing on behalf of forks - since their only determination of adoption rate is to mine the first block they recieve. This reduces network security as hashpower is split; this may be somewhat of a moot point in Saito, where sustained attack can never be profitable - but more security and faster block confirmation can't hurt. 

<h2> Naive Solution </h2>   

The solution is to put an onus on *block producers,* and to do it in a way that they will voluntarily participate in; that is, make them compete. Block production in Saito gives marginal explicit rewards; the more notable reward is implicit: the routing work in a block will likely favor the node that produced it. Given the possibility that the same transactions which reward that block producer may be produced in a competing node at the expense of the first, these nodes have some incentive to *pay* the network to adopt their own. This can be achieved rather naively: if you produce a block, include in it a transaction with inputs created in that block with outputs in the next, and attach a competitive fee. Now nodes which relay that block also have a fee-paying transaction which is only valid *for that block.*

The nodes the block is first relayed then have some monetary incentive to switch to that block over one without such a reward, and even nodes that will not substantially benefit from the reward can use the size of the reward and the quantity of routing signatures on it as a signal of the likelihood that the block is preferred over another received within a similar time-frame with a low reward and fewer signatures, rather than waiting for miners to produce Golden Ticket which will take on average another full block to produce. Not only that, but miners can also use this signal to select which fork to direct hashpower towards, meaning they bear less the cost of betting on forks and better concentrate security. This attached reward and corresponding signature set works similarly to stake and attestations in Ethereum. But there are incentive issues which allow free attacks on any nodes attempting accept this 'stake' trustlessly. 

Nodes receiving blocks run the risk of adopting a block with poor chances of being widely accepted by being baited in by the fee the block producer attached - attackers may target certain nodes with such blocks while withholding it from the rest of the network in order to lead nodes astray. Since the attackers know the block is unlikely to be accepted by the network, they can be reasonably sure that the attached fee remains unspent and have effectively griefed other nodes onto an orphaned fork for free. This should give pause to nodes using such incentives to change their view of consensus, which ultimately makes them pointless since they will revert back to adopting the first block no matter what fee reward is available. The naive way around this is a trust or reputation system between nodes sending such transactions - but perhaps a more open approach is possible.

<h2> Block Enticement Transactions (BETs) </h2>

This is where the concept of a BET comes in: a Block Enticement Transaction. Unlike the naive enticement transaction which uses inputs unique to the newly produced block, BETs are not invalid if the block they reference is not eventually adopted by the network at large. All else being equal: as a network node deciding between two blocks at a single depth, where one has a naive enticement and the other has a BET, the obvious choice is the one with an included BET. Even if the block referred to by the BET does not end up adopted by the network, it will still pay that node, whereas the naive enticement is a sunk cost when the block it requires for validity is orphaned.

The question then is: 'if a BET always pays its reward, what is the incentive to adopt its referenced block over any other?' BETs contain logic which reduces their reward ny half if they are included on a fork absent their referenced block. This reward could be distributed to miners and stakers, but given the fact that a failed BET only pays routers half the fee, the issuer of the BET can easily re-use the same inputs while paying routing nodes anything greater than half the original fee and convince them to publish a transaction which supersedes the bet. Since the cost of this is exploit is half the BET fee, it is easier to simply incant the BET logic with the 50% refund automatically.

All else being equal, network nodes will prefer a block with a BET over one with a naive enticement, and with the fully fleshed out BET logic, it is clear that network nodes deciding between multiple BETs with equal rewards received at the same time have a clear incentive to adopt the block with the greatest BET. All other BETs must still pay half their fee, which prevents block producers from griefing network nodes without paying them, but the BET which nodes will least desire to reduce in reward output is the one with the greatest fee. Ameliorating the potential griefing attacks allows blocks to trustlessly make decisions on blocks *upfront* just by information about their BETs.

<h2> The Open Analogue to Stake and Attestations </h2>

Stake and attestations provide a defensive monetary incentive to network participants which converges the network towards agreement on blocks before forks can progress. These incentives require a pre-determined set of participants with locked tokens in order to enforce the associated rules. Saito has shown that scalable blockchain can be designed without the need for such closure, and in the spirit of that accomplishment, BETs are a format, if well-founded, which nodes should require no altruism to begin adopting.

Rather than the punitive action closure relies on, BETs require no officiated set of participants and no preemptive locking of funds; the incentives involved are *positive.* By paying other nodes to adopt a block, block producers can increase their chance of being rewarded by their block. Nodes a short relay distance from the block producer can enjoy the associated rewards, even if another block is adopted, and nodes too deep to claim substantial rewards still gain valuable information from the BET size and the signature count in regards to which block is likely being adopted by the rest of the network. Rather than waiting for another block or Golden Ticket to be produced, nodes can gain this valuable information as soon as the block arrives.

The incentives don't just compensate some nodes when they adopt a yet orphaned block nor signal the likelihood of adoption to deeper nodes - they also reduce the incentive to produce differing blocks at a certain depth. This is because a late block with a BET the same size as an earlier one is easily ignored, and any larger BET, while possibly convincing to the nearest neighbors, will not be enticing to deeper nodes who have much more to gain being on a more up to date fork. More importantly, blocks produced near simultaneously have more risked involved in parallel propagation, as block producers risk spending their BET fee for nothing.

The incentives favor block producers who can spend more on the BET and still profit, which generally favors blocks with greater fees produced by more prolific nodes. If a block publisher is aware that there block does not have the reward or timing required to include a competitive BET, the incentive to publish that is reduced. This means, even before judging BETs and timings, there should end up being inherently less network forks as nodes are punished for producing redundant blocks with viable BETs at the same depth, thus less orphaned forks, contributing to an overall reduction in resources required by the network. In general this makes the network more efficient.

<h2> Call to Action? </h2>

This proposal was originally conceived as a Saito Improvement Proposal, but given the realization that a BET can likely be constructed with basic scripting logic, the need to accommodate such a scheme by altering consensus is probably not necessary. This proposal is then for those running Saito Nodes in the future. The ask is not to include BETs alongside new blocks because it helps the network - obviously such motivations do not scale.

If this scheme holds any water at all, block producers will do it because it makes them more money. In theory, this should be true - rather than letting the network decide if your routing work or a competing publisher is to be adopted when blocks are produced simultaneously, the block producer which can profitably include a larger BET will both aid in consensus and better secure their rewards. So long as the idea is sound, all else it takes is for the transaction format to exist, be accessible, and be understood.

More on that as the Saito Network develops.